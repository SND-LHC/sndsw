<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SND@LHC Software: analysis/tools/sndShowerTools.cxx File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">SND@LHC Software
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('sndShowerTools_8cxx.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">sndShowerTools.cxx File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="sndShowerTools_8h_source.html">sndShowerTools.h</a>&quot;</code><br />
<code>#include &lt;vector&gt;</code><br />
<code>#include &lt;algorithm&gt;</code><br />
<code>#include &lt;utility&gt;</code><br />
<code>#include &quot;<a class="el" href="sndConfiguration_8h_source.html">sndConfiguration.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="sndScifiPlane_8h_source.html">sndScifiPlane.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="sndUSPlane_8h_source.html">sndUSPlane.h</a>&quot;</code><br />
<code>#include &quot;TMatrixD.h&quot;</code><br />
<code>#include &quot;TMatrixDSym.h&quot;</code><br />
<code>#include &quot;TMatrixDSymEigen.h&quot;</code><br />
<code>#include &quot;TVectorD.h&quot;</code><br />
<code>#include &quot;TDecompChol.h&quot;</code><br />
<code>#include &quot;Math/Vector3D.h&quot;</code><br />
<code>#include &quot;Math/Point3D.h&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for sndShowerTools.cxx:</div>
<div class="dyncontent">
<div class="center"><img src="sndShowerTools_8cxx__incl.png" border="0" usemap="#aanalysis_2tools_2sndShowerTools_8cxx" alt=""/></div>
<map name="aanalysis_2tools_2sndShowerTools_8cxx" id="aanalysis_2tools_2sndShowerTools_8cxx">
<area shape="rect" title=" " alt="" coords="2215,5,2402,45"/>
<area shape="rect" href="sndShowerTools_8h.html" title=" " alt="" coords="1906,93,2045,119"/>
<area shape="poly" title=" " alt="" coords="2230,48,2038,93,2037,88,2228,43"/>
<area shape="rect" title=" " alt="" coords="1937,475,2000,500"/>
<area shape="poly" title=" " alt="" coords="2303,46,2283,105,2275,141,2271,178,2271,327,2269,348,2264,367,2243,400,2212,426,2174,447,2132,462,2090,473,2014,485,2013,480,2089,468,2131,457,2172,442,2209,422,2239,397,2259,365,2264,347,2266,327,2266,178,2269,140,2278,103,2298,44"/>
<area shape="rect" href="sndConfiguration_8h.html" title=" " alt="" coords="1277,240,1421,265"/>
<area shape="poly" title=" " alt="" coords="2215,38,2029,60,1921,76,1815,96,1685,127,1559,169,1467,204,1388,237,1386,232,1465,199,1557,164,1684,122,1814,91,1921,71,2029,55,2215,33"/>
<area shape="rect" href="sndScifiPlane_8h.html" title=" " alt="" coords="1669,167,1789,192"/>
<area shape="poly" title=" " alt="" coords="2215,33,2140,40,2053,52,1962,70,1874,96,1809,127,1756,161,1753,156,1806,122,1872,91,1961,65,2052,47,2139,35,2215,28"/>
<area shape="rect" title=" " alt="" coords="1906,240,2029,265"/>
<area shape="poly" title=" " alt="" coords="2292,47,2252,95,2237,123,2228,148,2217,171,2194,194,2159,216,2120,232,2043,249,2042,244,2118,226,2156,211,2191,190,2212,168,2223,146,2232,121,2248,92,2288,44"/>
<area shape="rect" href="sndUSPlane_8h.html" title=" " alt="" coords="1813,167,1924,192"/>
<area shape="poly" title=" " alt="" coords="2215,33,2126,40,2032,51,1950,70,1918,82,1896,95,1886,108,1879,122,1872,153,1867,152,1874,120,1881,105,1892,91,1916,77,1948,65,2031,46,2126,34,2215,28"/>
<area shape="rect" title=" " alt="" coords="2050,167,2181,192"/>
<area shape="poly" title=" " alt="" coords="2275,48,2238,69,2201,95,2166,127,2136,158,2133,154,2162,123,2198,91,2235,65,2272,43"/>
<area shape="rect" title=" " alt="" coords="2306,93,2391,119"/>
<area shape="poly" title=" " alt="" coords="2321,44,2339,80,2334,82,2316,47"/>
<area shape="rect" title=" " alt="" coords="2416,93,2476,119"/>
<area shape="poly" title=" " alt="" coords="2343,43,2415,84,2413,89,2340,48"/>
<area shape="rect" title=" " alt="" coords="2500,93,2595,119"/>
<area shape="poly" title=" " alt="" coords="2367,43,2500,87,2499,92,2365,48"/>
<area shape="rect" title=" " alt="" coords="2619,93,2742,119"/>
<area shape="poly" title=" " alt="" coords="2398,43,2614,88,2613,93,2397,48"/>
<area shape="rect" title=" " alt="" coords="2767,93,2925,119"/>
<area shape="poly" title=" " alt="" coords="2403,38,2755,89,2754,94,2402,43"/>
<area shape="rect" title=" " alt="" coords="2950,93,3043,119"/>
<area shape="poly" title=" " alt="" coords="2403,31,2641,54,2937,91,2936,96,2640,59,2402,37"/>
<area shape="rect" title=" " alt="" coords="3067,93,3193,119"/>
<area shape="poly" title=" " alt="" coords="2403,31,2690,54,3054,91,3054,96,2689,59,2402,36"/>
<area shape="poly" title=" " alt="" coords="1986,117,2016,168,2032,203,2043,239,2048,271,2046,304,2032,367,2009,422,1986,464,1982,461,2004,420,2027,365,2041,303,2042,272,2038,241,2027,205,2011,171,1981,120"/>
<area shape="poly" title=" " alt="" coords="1907,121,1790,142,1657,169,1517,205,1400,239,1399,233,1516,200,1656,164,1789,137,1906,116"/>
<area shape="poly" title=" " alt="" coords="1937,121,1782,165,1781,160,1935,116"/>
<area shape="poly" title=" " alt="" coords="1977,119,1971,226,1966,226,1972,119"/>
<area shape="poly" title=" " alt="" coords="1960,121,1899,161,1896,157,1957,116"/>
<area shape="poly" title=" " alt="" coords="1999,116,2082,158,2079,163,1997,121"/>
<area shape="rect" href="Scifi_8h.html" title=" " alt="" coords="557,313,618,339"/>
<area shape="poly" title=" " alt="" coords="1277,261,1004,281,830,296,656,316,632,319,631,314,655,311,830,291,1003,275,1276,256"/>
<area shape="rect" href="MuFilter_8h.html" title=" " alt="" coords="668,313,755,339"/>
<area shape="poly" title=" " alt="" coords="1277,265,769,321,768,316,1276,259"/>
<area shape="rect" title=" " alt="" coords="168,394,273,419"/>
<area shape="poly" title=" " alt="" coords="557,335,438,357,285,389,272,393,270,388,284,384,437,351,556,330"/>
<area shape="rect" title=" " alt="" coords="33,394,145,419"/>
<area shape="poly" title=" " alt="" coords="557,333,385,352,271,368,156,389,140,393,139,388,155,384,270,363,384,347,556,327"/>
<area shape="rect" href="SNDLHCEventHeader_8h.html" title=" " alt="" coords="502,394,673,419"/>
<area shape="poly" title=" " alt="" coords="590,339,590,380,585,380,585,339"/>
<area shape="rect" title=" " alt="" coords="309,475,367,500"/>
<area shape="poly" title=" " alt="" coords="557,331,430,336,260,346,104,364,50,375,22,389,12,403,8,416,10,427,17,437,46,454,90,466,142,475,197,480,295,484,295,489,197,485,141,480,89,472,44,459,14,441,5,429,3,416,7,401,19,385,49,370,103,358,259,341,430,331,556,326"/>
<area shape="rect" title=" " alt="" coords="801,394,880,419"/>
<area shape="poly" title=" " alt="" coords="619,333,790,384,798,387,797,392,788,389,618,338"/>
<area shape="rect" title=" " alt="" coords="1546,394,1637,419"/>
<area shape="poly" title=" " alt="" coords="619,331,656,336,789,347,902,352,1096,350,1189,349,1288,353,1401,363,1533,384,1548,388,1547,393,1532,389,1400,369,1288,358,1189,354,1096,355,902,357,789,353,655,341,618,336"/>
<area shape="rect" title=" " alt="" coords="297,394,427,419"/>
<area shape="poly" title=" " alt="" coords="557,341,409,392,407,387,556,335"/>
<area shape="poly" title=" " alt="" coords="640,417,685,424,870,443,1059,457,1424,475,1729,482,1924,484,1924,489,1728,488,1423,481,1059,463,870,448,684,429,639,422"/>
<area shape="rect" title=" " alt="" coords="392,475,481,500"/>
<area shape="poly" title=" " alt="" coords="566,422,472,471,470,466,564,417"/>
<area shape="rect" href="SNDLHCEventHeaderConst_8h.html" title=" " alt="" coords="505,475,715,500"/>
<area shape="poly" title=" " alt="" coords="593,419,605,461,600,462,588,420"/>
<area shape="rect" title=" " alt="" coords="739,475,798,500"/>
<area shape="poly" title=" " alt="" coords="615,417,731,467,729,472,613,422"/>
<area shape="rect" title=" " alt="" coords="846,475,897,500"/>
<area shape="poly" title=" " alt="" coords="629,417,834,473,832,478,628,422"/>
<area shape="poly" title=" " alt="" coords="552,422,382,475,380,470,550,417"/>
<area shape="rect" title=" " alt="" coords="577,548,643,573"/>
<area shape="poly" title=" " alt="" coords="613,500,613,534,607,534,607,500"/>
<area shape="poly" title=" " alt="" coords="668,336,630,341,457,361,381,371,285,389,270,393,269,388,284,384,381,366,456,356,630,336,668,331"/>
<area shape="poly" title=" " alt="" coords="668,336,630,341,497,354,392,360,288,369,156,389,139,393,138,388,155,384,288,363,392,355,496,349,630,336,668,331"/>
<area shape="poly" title=" " alt="" coords="695,341,619,389,616,384,692,337"/>
<area shape="poly" title=" " alt="" coords="669,336,584,355,537,370,491,389,466,408,441,429,373,470,370,466,438,425,462,403,489,384,535,365,583,350,667,331"/>
<area shape="poly" title=" " alt="" coords="732,337,811,384,809,389,729,341"/>
<area shape="poly" title=" " alt="" coords="755,324,887,325,1080,333,1305,351,1421,365,1533,384,1548,387,1546,393,1532,389,1420,371,1305,356,1080,338,887,331,755,330"/>
<area shape="poly" title=" " alt="" coords="668,340,427,394,425,388,667,334"/>
<area shape="rect" title=" " alt="" coords="697,394,777,419"/>
<area shape="poly" title=" " alt="" coords="718,338,731,380,726,382,713,340"/>
<area shape="poly" title=" " alt="" coords="1743,190,1793,238,1829,273,1862,312,1917,393,1958,461,1954,464,1913,396,1857,315,1825,277,1790,242,1740,194"/>
<area shape="poly" title=" " alt="" coords="1669,194,1424,240,1423,235,1668,189"/>
<area shape="poly" title=" " alt="" coords="1672,195,1586,215,1491,242,1463,256,1434,268,1317,292,1218,305,1130,309,1047,308,875,303,774,306,656,316,632,319,631,314,655,311,774,301,875,298,1047,303,1130,304,1218,299,1316,287,1432,263,1461,251,1489,238,1584,210,1670,189"/>
<area shape="rect" href="sndScifiHit_8h.html" title=" " alt="" coords="1677,240,1780,265"/>
<area shape="poly" title=" " alt="" coords="1731,192,1731,226,1726,226,1726,192"/>
<area shape="poly" title=" " alt="" coords="1768,189,1916,233,1915,239,1766,195"/>
<area shape="poly" title=" " alt="" coords="1680,268,1586,292,1548,305,1529,315,1524,332,1531,350,1546,368,1564,384,1561,388,1542,372,1526,353,1519,332,1525,312,1546,300,1585,287,1678,263"/>
<area shape="rect" href="SndlhcHit_8h.html" title=" " alt="" coords="1318,313,1414,339"/>
<area shape="poly" title=" " alt="" coords="1678,267,1429,315,1428,310,1677,261"/>
<area shape="rect" title=" " alt="" coords="1796,394,1880,419"/>
<area shape="poly" title=" " alt="" coords="1771,263,1807,282,1824,295,1838,312,1845,329,1848,347,1846,380,1841,380,1843,347,1840,330,1833,315,1820,299,1804,286,1768,268"/>
<area shape="rect" href="ScifiPoint_8h.html" title=" " alt="" coords="1684,313,1779,339"/>
<area shape="poly" title=" " alt="" coords="1732,266,1733,300,1728,300,1727,266"/>
<area shape="poly" title=" " alt="" coords="1318,336,944,389,894,398,893,393,943,384,1317,331"/>
<area shape="poly" title=" " alt="" coords="1400,336,1547,387,1545,392,1398,341"/>
<area shape="poly" title=" " alt="" coords="1414,329,1579,347,1682,363,1784,384,1796,387,1794,392,1783,389,1681,368,1578,352,1414,334"/>
<area shape="rect" title=" " alt="" coords="1123,394,1206,419"/>
<area shape="poly" title=" " alt="" coords="1338,341,1207,392,1206,387,1336,336"/>
<area shape="rect" title=" " alt="" coords="1231,394,1355,419"/>
<area shape="poly" title=" " alt="" coords="1357,341,1315,385,1311,382,1353,337"/>
<area shape="rect" title=" " alt="" coords="1379,387,1521,427"/>
<area shape="poly" title=" " alt="" coords="1380,337,1422,375,1418,379,1377,341"/>
<area shape="rect" title=" " alt="" coords="956,387,1099,427"/>
<area shape="poly" title=" " alt="" coords="1319,341,1113,388,1112,383,1317,336"/>
<area shape="poly" title=" " alt="" coords="1712,341,1625,390,1623,385,1709,337"/>
<area shape="poly" title=" " alt="" coords="1749,337,1813,384,1810,388,1746,341"/>
<area shape="rect" title=" " alt="" coords="1661,394,1772,419"/>
<area shape="poly" title=" " alt="" coords="1732,339,1724,381,1719,380,1727,338"/>
<area shape="poly" title=" " alt="" coords="1873,192,1881,225,1896,264,1907,278,1918,287,1929,297,1939,312,1954,351,1963,392,1971,461,1966,461,1958,393,1949,353,1934,315,1925,300,1914,291,1903,282,1892,267,1876,227,1868,193"/>
<area shape="poly" title=" " alt="" coords="1814,193,1801,195,1435,244,1434,238,1800,189,1813,187"/>
<area shape="poly" title=" " alt="" coords="1814,193,1535,243,1509,256,1481,268,1380,279,1177,295,769,323,768,318,1176,289,1379,274,1480,263,1506,251,1533,237,1813,187"/>
<area shape="poly" title=" " alt="" coords="1886,190,1942,230,1939,234,1883,194"/>
<area shape="rect" href="MuFilterHit_8h.html" title=" " alt="" coords="1546,240,1653,265"/>
<area shape="poly" title=" " alt="" coords="1826,195,1657,239,1655,234,1825,189"/>
<area shape="poly" title=" " alt="" coords="1546,265,1209,324,1039,359,979,375,945,389,925,405,908,424,884,464,880,461,904,421,921,401,942,384,977,370,1038,354,1208,319,1545,260"/>
<area shape="poly" title=" " alt="" coords="1553,268,1515,286,1499,299,1486,315,1481,326,1482,336,1495,355,1518,373,1546,386,1544,391,1515,377,1491,359,1477,337,1476,325,1481,312,1495,295,1513,281,1551,263"/>
<area shape="poly" title=" " alt="" coords="1563,268,1418,312,1416,307,1561,263"/>
<area shape="poly" title=" " alt="" coords="1652,263,1732,285,1767,298,1792,311,1807,327,1818,345,1834,380,1829,382,1814,347,1802,330,1788,315,1765,302,1730,290,1651,268"/>
<area shape="rect" href="MuFilterPoint_8h.html" title=" " alt="" coords="1539,313,1659,339"/>
<area shape="poly" title=" " alt="" coords="1602,266,1602,300,1597,300,1597,266"/>
<area shape="poly" title=" " alt="" coords="1601,339,1597,380,1591,380,1596,339"/>
<area shape="poly" title=" " alt="" coords="1636,336,1784,384,1793,387,1792,392,1783,389,1635,341"/>
<area shape="poly" title=" " alt="" coords="1618,337,1689,384,1686,388,1615,341"/>
</map>
</div>
</div>
<p><a href="sndShowerTools_8cxx_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:abb52a18fc714ecf62e97408ab0d5e102" id="r_abb52a18fc714ecf62e97408ab0d5e102"><td class="memItemLeft" align="right" valign="top">std::pair&lt; double, double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sndShowerTools_8cxx.html#abb52a18fc714ecf62e97408ab0d5e102">PCA</a> (const std::vector&lt; double &gt; &amp;u, const std::vector&lt; double &gt; &amp;z)</td></tr>
<tr class="separator:abb52a18fc714ecf62e97408ab0d5e102"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="abb52a18fc714ecf62e97408ab0d5e102" name="abb52a18fc714ecf62e97408ab0d5e102"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb52a18fc714ecf62e97408ab0d5e102">&#9670;&#160;</a></span>PCA()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::pair&lt; double, double &gt; PCA </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>z</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="sndShowerTools_8cxx_source.html#l00152">152</a> of file <a class="el" href="sndShowerTools_8cxx_source.html">sndShowerTools.cxx</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  153</span>{</div>
<div class="line"><span class="lineno">  154</span>  <span class="comment">// Need at least 3 measurements</span></div>
<div class="line"><span class="lineno">  155</span>  assert(u.size() == <a class="code hl_variable" href="namespacecharm-geometry__config.html#ab2e80a101e23d81f6afc4b1fd8e76761">z</a>.size() &amp;&amp; u.size() &gt;= 2);</div>
<div class="line"><span class="lineno">  156</span>  <span class="keyword">const</span> <span class="keywordtype">size_t</span> n_samples = u.size();</div>
<div class="line"><span class="lineno">  157</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> n_variables = 2;</div>
<div class="line"><span class="lineno">  158</span> </div>
<div class="line"><span class="lineno">  159</span>  <span class="comment">// Find the mean values</span></div>
<div class="line"><span class="lineno">  160</span>  <span class="keywordtype">double</span> mean_u = 0.0, mean_z = 0.0;</div>
<div class="line"><span class="lineno">  161</span>  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; <a class="code hl_variable" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a> &lt; n_samples; ++<a class="code hl_variable" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>)</div>
<div class="line"><span class="lineno">  162</span>  {</div>
<div class="line"><span class="lineno">  163</span>    mean_u += u[<a class="code hl_variable" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>];</div>
<div class="line"><span class="lineno">  164</span>    mean_z += <a class="code hl_variable" href="namespacecharm-geometry__config.html#ab2e80a101e23d81f6afc4b1fd8e76761">z</a>[<a class="code hl_variable" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>];</div>
<div class="line"><span class="lineno">  165</span>  }</div>
<div class="line"><span class="lineno">  166</span>  mean_u /= n_samples;</div>
<div class="line"><span class="lineno">  167</span>  mean_z /= n_samples;</div>
<div class="line"><span class="lineno">  168</span> </div>
<div class="line"><span class="lineno">  169</span>  <span class="comment">// Find the covariance components</span></div>
<div class="line"><span class="lineno">  170</span>  <span class="keywordtype">double</span> cov_uu = 0.0, cov_zz = 0.0, cov_uz = 0.0;</div>
<div class="line"><span class="lineno">  171</span>  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; <a class="code hl_variable" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a> &lt; n_samples; ++<a class="code hl_variable" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>)</div>
<div class="line"><span class="lineno">  172</span>  {</div>
<div class="line"><span class="lineno">  173</span>    <span class="keywordtype">double</span> du = u[<a class="code hl_variable" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>] - mean_u;</div>
<div class="line"><span class="lineno">  174</span>    <span class="keywordtype">double</span> dz = <a class="code hl_variable" href="namespacecharm-geometry__config.html#ab2e80a101e23d81f6afc4b1fd8e76761">z</a>[<a class="code hl_variable" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>] - mean_z;</div>
<div class="line"><span class="lineno">  175</span>    cov_uu += du * du;</div>
<div class="line"><span class="lineno">  176</span>    cov_zz += dz * dz;</div>
<div class="line"><span class="lineno">  177</span>    cov_uz += du * dz;</div>
<div class="line"><span class="lineno">  178</span>  }</div>
<div class="line"><span class="lineno">  179</span> </div>
<div class="line"><span class="lineno">  180</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> denom = (n_samples &gt; 1) ? (n_samples - 1.0) : 1.0;</div>
<div class="line"><span class="lineno">  181</span>  cov_uu /= denom;</div>
<div class="line"><span class="lineno">  182</span>  cov_zz /= denom;</div>
<div class="line"><span class="lineno">  183</span>  cov_uz /= denom;</div>
<div class="line"><span class="lineno">  184</span> </div>
<div class="line"><span class="lineno">  185</span>  <span class="comment">// Fill the covariance matrix</span></div>
<div class="line"><span class="lineno">  186</span>  TMatrixDSym cov_matrix(n_variables);</div>
<div class="line"><span class="lineno">  187</span>  cov_matrix[0][0] = cov_uu;</div>
<div class="line"><span class="lineno">  188</span>  cov_matrix[0][1] = cov_uz;</div>
<div class="line"><span class="lineno">  189</span>  cov_matrix[1][0] = cov_uz;</div>
<div class="line"><span class="lineno">  190</span>  cov_matrix[1][1] = cov_zz;</div>
<div class="line"><span class="lineno">  191</span> </div>
<div class="line"><span class="lineno">  192</span>  <span class="comment">// Find the eigenvalues and eigenvectors. For now we only need the former.</span></div>
<div class="line"><span class="lineno">  193</span>  <span class="comment">// Perhaps the eigenvectors could be used in the future, so left that part in comments.</span></div>
<div class="line"><span class="lineno">  194</span>  TMatrixDSymEigen eig_decomp(cov_matrix);</div>
<div class="line"><span class="lineno">  195</span>  TVectorD evals = eig_decomp.GetEigenValues();</div>
<div class="line"><span class="lineno">  196</span>  <span class="comment">//TMatrixD evecs = eig_decomp.GetEigenVectors();</span></div>
<div class="line"><span class="lineno">  197</span> </div>
<div class="line"><span class="lineno">  198</span>  <span class="comment">// Make sure the order is descending, swap if needed</span></div>
<div class="line"><span class="lineno">  199</span>  <span class="keywordflow">if</span> (evals[0] &lt; evals[1])</div>
<div class="line"><span class="lineno">  200</span>  {</div>
<div class="line"><span class="lineno">  201</span>    std::swap(evals[0], evals[1]);</div>
<div class="line"><span class="lineno">  202</span>    <span class="comment">//evecs[0] = eig_decomp.GetEigenVectors()[1];</span></div>
<div class="line"><span class="lineno">  203</span>    <span class="comment">//evecs[1] = eig_decomp.GetEigenVectors()[0];</span></div>
<div class="line"><span class="lineno">  204</span>  }</div>
<div class="line"><span class="lineno">  205</span> </div>
<div class="line"><span class="lineno">  206</span>  <span class="keywordflow">return</span> {evals[0], evals[1]};</div>
<div class="line"><span class="lineno">  207</span>}</div>
<div class="ttc" id="anamespaceShipAna_html_aa4bf87f4d17f9d38b1d8f4d009bb54b3"><div class="ttname"><a href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">ShipAna.i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition</b> <a href="ShipAna_8py_source.html#l00086">ShipAna.py:86</a></div></div>
<div class="ttc" id="anamespacecharm-geometry__config_html_ab2e80a101e23d81f6afc4b1fd8e76761"><div class="ttname"><a href="namespacecharm-geometry__config.html#ab2e80a101e23d81f6afc4b1fd8e76761">charm-geometry_config.z</a></div><div class="ttdeci">z</div><div class="ttdef"><b>Definition</b> <a href="charm-geometry__config_8py_source.html#l00007">charm-geometry_config.py:7</a></div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_b8678fa8510b7ff9a55ffd4d18fd5e47.html">analysis</a></li><li class="navelem"><a class="el" href="dir_4a13cf389b54da80322846b5d044681d.html">tools</a></li><li class="navelem"><a class="el" href="sndShowerTools_8cxx.html">sndShowerTools.cxx</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
